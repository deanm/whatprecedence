(function(exports){/*
 (c) 2014 dean@gmail.com http://github.com/deanm/omgc */
function k(){throw"Unexpected (nud) encounter of token type: '"+this.a+"'";}function n(){throw"Unexpected (led) encounter of token type: '"+this.a+"'";}function q(d,c,b,e){return{a:"op_b",g:d,l:c,f:e,i:0===c?n:function(b,a){this.d=c;this.b=b;this.c=a.h(c+("right"===e?0.1:0));return this},j:0===b?k:function(c){this.a="op_u";this.d=b;this.f="right";this.b=c.h(b);return this}}}
function r(){return{a:"op_u",g:"sizeof",f:"right",i:n,j:function(d){this.d=3;this.f="right";if("op_u_typecast"===d.e.a)this.b=d.e.b,d.k();else if(this.b=d.h(3),"typespec"===this.b.a)throw"Cannot use type in expression: "+this.b.b;return this}}}function s(d,c,b,e){return{a:"num",q:d,b:c,t:b,s:e,i:n,j:function(){return this}}}function u(d){return{a:"typespec",b:d,i:n,j:function(){return this}}}function v(d,c,b){return s("int",d,c,b)}
function w(d){return{a:"op_u_typecast",d:3,f:"right",i:n,b:u(d),j:function(c){this.c=c.h(3.1);return this}}}function x(d,c){return function(b){return q(b,d,c,"left")}}function y(d,c){return function(b){return q(b,d,c,"right")}}function z(d){return function(c){return{a:"op_u",g:c,l:d,i:function(b){this.a+="_s";this.d=d;this.f="left";this.b=b;return this},j:function(b){this.f="right";this.d=3;this.b=b.h(3);return this}}}}var A={};function B(){return function(){return A}}
var C={" ":B(),"\t":B(),"\r":B(),"\n":B(),"++":z(1),"--":z(2),".":x(2,0),"->":x(2,0),"!":y(0,3),"~":y(0,3),"*":x(5,3),"/":x(5,0),"%":x(5,0),"+":x(6,3),"-":x(6,3),"<<":x(7,0),">>":x(7,0),"<=":x(8,0),">=":x(8,0),"==":x(9,0),"!=":x(9,0),"&":x(10,3),"^":x(11,0),"|":x(12,0),"&&":x(13,0),"||":x(14,0),"=":y(16,0),"+=":y(16,0),"-=":y(16,0),"*=":y(16,0),"/=":y(16,0),"%=":y(16,0),"<<=":y(16,0),">>=":y(16,0),"&=":y(16,0),"^=":y(16,0),"|=":y(16,0),",":x(18,0)},D=/^[uU](?:ll|LL)|^[uU][lL]?|^(?:ll|LL)[uU]?|^[lL][uU]?/,
E=[/^(?:[0-9]*\.[0-9]+|[0-9]+\.)(?:[eE][+-]?[0-9]+)?|^[0-9]+[eE][+-]?[0-9]+/,/^[fFlL]/,parseFloat,function(d,c,b){return s("flt",d,c,b)},/^0[xX][0-9a-fA-F]+/,D,function(d){return parseInt(d,16)},v,/^0[0-7]*/,D,function(d){return parseInt(d,8)},v,/^[1-9][0-9]*/,D,function(d){return parseInt(d,10)},v,/^[a-zA-Z_][a-zA-Z0-9_]*/,null,null,function(d){return{a:"sym",b:d,i:n,j:function(){return this}}}],F=["signed","unsigned","short","long"],G="void;char;int;float;double;_Bool;wchar_t;char16_t;char32_t;float_t;double_t;int8_t, uint8_t;int16_t, uint16_t;int32_t, uint32_t;int64_t, uint64_t;intptr_t, uintptr_t;size_t;ssize_t;ptrdiff_t".split(";");
function H(d){function c(){if(e>=l)throw"Unexpected end of input";for(var a,g=d.substr(e),h=3,f=E.length;h<f;h+=4)if(null!==(a=g.match(E[h-3]))){var m=E[h-2],f=E[h-1],h=E[h],g=a[0];e+=g.length;f=null!==f?f(g):g;if(null===m)return"sizeof"===f?r():-1!==F.indexOf(f)||-1!==G.indexOf(f)?u(f):h(f);var p="";null!==(a=d.substr(e).match(m))&&(p=a[0],e+=p.length);return h(f,p,g+p)}for(a=3;0<a;--a)if(e+a<=l&&(m=d.substr(e,a),h=C[m],void 0!==h))return e+=a,h(m);switch(m){case ")":case "]":return++e,{a:m,i:n,
j:k};case "(":++e;if((a=b())&&"typespec"===a.a){a=[];for(h=m=!1;;)if(g=c(),g!==A){if(")"===g.a)break;if("op_b"===g.a&&"*"===g.g){if(!1===h)throw"* in typecast before any type";a.push("*");m=!0}else if("typespec"===g.a&&-1!==F.indexOf(g.b)){if(!0===h)throw"Typecast qualifier after a type";if(!0===m)throw"Typecast qualifier after a *";a.push(g.b);seen_qualifier=!0}else if("typespec"===g.a&&-1!==G.indexOf(g.b)){if(!0===h)throw"Typecast type after another type";if(!0===m)throw"Typecast type after a *";
a.push(g.b);h=!0}else throw"Unexpected non-typey symbol in typecast: "+g.a;}return w(a.join(" "))}return{a:"_paren",l:2,i:function(a,b){var c=null,e={c:null},d=e;if(")"!==b.e.a)for(;;){c=b.h(18);c={a:"funarg",b:c,c:null};d=d.c=c;if("op_b"!==b.e.a||","!==b.e.g)break;b.k()}if(")"!==b.k())throw"Unmatched left parenthesis";return{a:"fun",l:2,d:2,f:"left",b:a,c:e.c}},j:function(a){if(")"===a.e.a)throw"Empty parentheses expression";var b=a.h(20);if(")"!==a.k())throw"Unmatched left parenthesis";return b}};
case "[":return++e,{a:"op_b[]",l:2,f:"left",i:function(a,b){this.d=2;if("]"===b.e.a)throw"Empty subscript";var c=b.h(20);if("]"!==b.k())throw"Unmatched left bracket";this.b=a;this.c=c;return this},j:k};case ":":return++e,{a:":"};case "?":return++e,{a:"op_t",g:"?:",f:"right",l:15,i:function(a,b){this.d=15;this.b=a;this.o=b.h(20);if(":"!==b.k())throw"Unmatched : for ?.";this.c=b.h(15.1);return this},j:k}}throw"Failed in lexing input: "+d.substr(e);}function b(){for(var a=e;e<l;){var b=c();if(b!==A)return e=
a,b}e=a;return null}var e=0,l=d.length;this.n=function(){for(;e<l;){var a=c();if(a!==A)return a}return null}}function I(d){var c={l:20,a:"end"};this.e=c;this.m=function(){return this.e===c};this.k=function(){var b=this.e.a,e=d.n();this.e=null===e?c:e;return b};this.h=function(b){if(this.m())return null;var c=this.e;this.k();for(var d=c.j(this);b>this.e.l;)c=this.e,this.k(),d=c.i(d,this);return d};this.k()}function J(d){d=new I(d);var c=d.h(19);if(!d.m())throw"Trailing token: "+d.e.a;return c}
try{exports.CLexer=H,exports.build_ast=J}catch(K){};/*
 (c) 2014 dean@gmail.com http://github.com/deanm/omgc */
function L(d,c,b,e,l,a){function g(){-1!==m&&a.push({type:"",text:"(",opt:0===m})}function h(){-1!==m&&a.push({type:"",text:")",opt:0===m})}if(null===b)throw"Operator missing operand?";var f=b.a,m=l.r(d,c,b,e);++d;switch(f){case "num":e=b.s;c="flt"===b.q?"floating point number":"integer number";a.push({type:"num",desc:c,text:e});break;case "sym":a.push({type:"sym",desc:"identifier",text:b.b});break;case "typespec":throw"Cannot use type in expression: "+b.b;case "fun":f=[null,null];c="operator function call";
var p={type:"op_u",text:"(",desc:c,p:f},t={type:"op_u",text:")",desc:c,p:f};c={type:"op_u",text:", ",desc:c,p:f};g();f[0]=a.length;e=L(d,"left",b.b,b,l,a);f[1]=a.length;a.push(p);for(e=b.c;null!==e;e=e.c)f.push(a.length),L(d,"funarg",e.b,b,l,a),f.push(a.length),null!==e.c&&a.push(c);a.push(t);h();break;case "op_b[]":g();f=[null,null,null,null];c="binary operator subscript";p={type:"op_u",text:"[",desc:c,p:f};t={type:"op_u",text:"]",desc:c,p:f};f[0]=a.length;e=L(d,"left",b.b,b,l,a);f[1]=a.length;a.push(p);
f[2]=a.length;L(d,"subscript",b.c,b,l,a);f[3]=a.length;a.push(t);h();break;case "op_u_typecast":if("typespec"!==b.b.a)throw"Typecast's left is not a typespec node";g();f=[null,null,null,null];e="("+b.b.b+")";p={type:"op_u",text:e,desc:"unary operator typecast",p:f};f[0]=a.length;a.push(p);f[1]=a.length;f[2]=a.length;L(d,"typecast",b.c,b,l,a);f[3]=a.length;h();break;case "op_u":case "op_u_s":c=b.f+" associative "+("op_u"===f?"prefix":"postfix")+" unary operator "+b.g;e=b.g;"sizeof"===e&&(e+=" ");c=
{type:f,text:e,desc:c,p:[null,null]};g();"op_u"===f&&a.push(c);c.p[0]=a.length;"typespec"===b.b.a?(a.push({type:"",text:"("}),a.push({type:"typespec",desc:"type",text:b.b.b}),a.push({type:"",text:")"})):L(d,"op_u"===f?"right":"left",b.b,b,l,a);c.p[1]=a.length;"op_u_s"===f&&a.push(c);h();break;case "op_b":c=b.f+" associative binary operator "+b.g;g();f=e=" ";if("."===b.g||"->"===b.g)e=f="";","===b.g&&(e="");c={type:"op_b",text:e+b.g+f,desc:c,p:[null,null,null,null]};c.p[0]=a.length;L(d,"left",b.b,
b,l,a);c.p[1]=a.length;a.push(c);c.p[2]=a.length;L(d,"right",b.c,b,l,a);c.p[3]=a.length;h();break;case "op_t":c="right associative ternary operator ?:";f=[null,null,null,null,null,null];p={type:"op_t",text:" ? ",desc:c,p:f};t={type:"op_t",text:" : ",desc:c,p:f};g();f[0]=a.length;L(d,"left",b.b,b,l,a);f[1]=a.length;a.push(p);f[2]=a.length;L(d,"middle",b.o,b,l,a);f[3]=a.length;a.push(t);f[4]=a.length;L(d,"right",b.c,b,l,a);f[5]=a.length;h();break;default:throw"Unknown node: "+b.a;}}
function M(d){var c=[];L(0,"root",d,null,{r:function(b,c,d,a){return 0===b?-1:"subscript"===c?0:"funarg"===c?"op_b"===d.a&&","===d.g?1:-1:d.d<a.d||"right"===c&&"right"===a.f&&d.d<=a.d||"left"===c&&"left"===a.f&&d.d<=a.d?0:1}},c);return c}try{exports.generate_blocks=M}catch(N){};})(window)
